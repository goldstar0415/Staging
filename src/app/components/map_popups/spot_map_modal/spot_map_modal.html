<script type="text/ng-template" id="SpotMapModal.html">
  <div class="modal-body">

    <button type="button" class="close" data-dismiss="alert" aria-label="Close"
            ng-click="close()">
      <span aria-hidden="true">Ã—</span>
    </button>

    <ul class="tabs">
      <li><a ng-click="view = 'about'">About</a>
      </li>
      <li><a ng-click="view = 'reviews'">Reviews</a>
      </li>
      <li><a ng-click="view = 'photos'">Photos</a>
      </li>
    </ul>

    <div class="col-xs-12 popup-main">

      <div class="col-xs-12 rating-mobile">
        <stars item="data.spot"></stars>
      </div>

      <div class="col-xs-12 no-pad">
        <h3 class="col-xs-12 no-pad">
          <a class="title" ui-sref="spot({spot_id: data.spot.id, user_id: data.spot.user_id})"
            >{{::data.spot.title}}</a>
        </h3>

        <p class="location">{{::data.address}}</p>

        <p class="date-popup" ng-if="data.spot.category.type.name == 'event'">
          <span>{{data.spot.start_date | toTimezone : 'DD MMM YYYY'}}</span> - <span>{{data.spot.end_date | toTimezone : 'DD MMM YYYY'}}</span>
        </p>

        <a class="author-popup" ui-sref="profile.main({user_id: data.spot.user.alias || data.spot.user_id})" ng-if="data.spot.user">{{'by ' + data.spot.user.first_name
          + ' ' + data.spot.user.last_name}}</a>
      </div>

      <div class="content-popup col-xs-12">

        <div ng-show="view == 'about'" class="col-xs-12 wrapper">
          <p class="description">{{data.spot.description}}</p>
        </div>

        <div ng-show="view == 'reviews'" class=" col-xs-12 reviews-popup">
          <div ng-if="data.spot.comments.length > 0">
            <div class="col-xs-12 previous-next" ng-if="data.spot.comments.length > 1">
              <a ng-click="prevReview()" class="previous">Previous</a> <a ng-click="nextReview()" class="next ">Next</a>
            </div>
            <div class="col-xs-2 avatar">
              <img ng-src="{{currentReview.sender.avatar_url.thumb}}">
            </div>
            <div class="col-xs-10 content">
              <span><a class="reviews-user">{{currentReview.sender.first_name + ' ' + currentReview.sender.last_name}}</a></span>

              <p class="description line-break" ng-bind-html="currentReview.body | linky:'_blank'"></p>

              <p class="date-reviews ">{{currentReview.created_at | toTimezone: 'DD MMM YYYY [at] hh:mm a'}}</p>

            </div>
          </div>

          <div ng-if="!data.spot.comments.length" class="photos-event clearfix">
            <span>here is no reviews yet</span>
          </div>
        </div>

        <div ng-show="view == 'photos'" class=" col-xs-12 wrapper">
          <div ng-if="showPhotosControls" class="col-xs-12 previous-next">
            <a ng-click="prevPhoto()" class="previous">Previous</a>
            <a ng-click="nextPhoto()" class="next">Next</a>
          </div>

          <div ng-if="showPhotos" class="col-xs-12 photos-popup">
            <a photo-viewer items="data.spot.photos" index="firstPhotoIndex" current-item="firstItem">
              <img ng-src="{{firstPhoto}}">
            </a>
            <a ng-if="secondItem" photo-viewer items="data.spot.photos" index="secondPhotoIndex"
               current-item="secondItem">
              <img ng-src="{{secondPhoto}}">
            </a>
          </div>

          <div ng-if="!showPhotos" class="photos-event clearfix">
            <span>here is no photos yet</span>
          </div>

        </div>

      </div>
      <div class="links-nav col-xs-12">
        <ul class="tools">

          <li ng-if="!data.spot.is_saved">
            <a class="save-event" ng-click="saveToCalendar(data.spot)">Save</a>
          </li>
          <li ng-if="$root.currentUser && data.spot.is_saved">
            <a class="save-event saved clicked" ng-click="removeFromCalendar(data.spot)">Remove</a>
          </li>
          <li ng-if="$root.currentUser.id != data.spot.user_id && !data.spot.is_favorite">
            <a class="favorite-spot" ng-click="addToFavorite(data.spot)">Favorite</a>
          </li>
          <li ng-if="$root.currentUser.id != data.spot.user_id && data.spot.is_favorite">
            <a class="fav favorited" ng-click="removeFromFavorite(data.spot)">Unfavorite</a>
          </li>
          <li>
            <invite-friends item="data.spot"></invite-friends>
          </li>
        </ul>

        <share item="data.spot" type="spot"></share>
      </div>
    </div>

  </div>
</script>
