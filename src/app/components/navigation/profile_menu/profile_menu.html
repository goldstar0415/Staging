<div class="col-xs-12 menu-profile">
  <div class="container">
    <div class="col-xs-10 col-xs-offset-2 no-pad">
      <ul ng-if="$root.currentUser && $root.currentUser.id == $root.profileUser.id">
        <li>
          <a ui-sref="spots({user_id: $root.currentUser.id})"
             ng-class="{active: Profile.$state.current.name == 'spots' || Profile.$state.current.name == 'spot'}">
            My spots
          </a>
        </li>
        <li ng-if="$root.isRole($root.currentUser, 'blogger')">
          <a ui-sref="profile_blog({user_id: $root.currentUser.id})" ui-sref-active="active">My blog</a>
        </li>
        <li><a ui-sref="favorites({user_id: $root.currentUser.id})" ui-sref-active="active">Favorites</a></li>
        <li><a ui-sref="areas" ui-sref-active="active">Saved searches</a></li>
        <li><a ui-sref="friendsmap" ui-sref-active="active">Friends map</a></li>
        <li><a ui-sref="photos.list({user_id: $root.currentUser.id})" ng-class="Profile.isActive('photos')">Photo
          map</a>
        </li>
        <li><a ui-sref="planner.list" ng-class="Profile.isActive('planner')">Planner </a></li>
        <li><a ui-sref="settings" ui-sref-active="active">Settings</a></li>
      </ul>
      <ul ng-if="$root.currentUser && $root.currentUser.id != $root.profileUser.id">
        <li ng-if="Profile.checkPermision(profileUser.privacy_events)">
          <a ui-sref="spots({user_id: $root.profileUser.id})"
             ng-class="{active: Profile.$state.current.name == 'spots' || Profile.$state.current.name == 'spot'}"
             class="my-spots">Spots</a>
        </li>
        <li ng-if="Profile.checkPermision(profileUser.privacy_favorites)">
          <a ui-sref="favorites({user_id: $root.profileUser.id})" ui-sref-active="active"
             class="favorites">Favorites</a>
        </li>
        <li ng-if="Profile.checkPermision(profileUser.privacy_photo_map)">
          <a ui-sref="photos.list({user_id: $root.profileUser.id})" ng-class="Profile.isActive('photos')"
             class="photomap">Photo
            map</a>
        </li>
        <li ng-if="$root.isRole($root.profileUser, 'blogger')">
          <a ui-sref="profile_blog({user_id: $root.profileUser.id})" ui-sref-active="active">Blog</a>
        </li>
      </ul>

      <div ng-if="!$root.currentUser" class="unauthorized">
        <b>You should &nbsp;
          <sign-in title="sign in" class="sign-in"></sign-in>
          &nbsp;to get all features</b>
      </div>
    </div>
  </div>
</div>


<div class="col-xs-12">
  <div class="container wrap">

    <div class="col-xs-12 col-md-2 information-profile">
      <section class="col-xs-2 col-sm-2 col-md-12 avatar-wrap" ng-if="$root.profileUser.id">
        <a ui-sref="profile.main({user_id: $root.profileUser.alias || $root.profileUser.id})" class="avatar">
          <img ng-src="{{$root.profileUser.avatar_url.medium}}"/>
        </a>
      </section>
      <section class="col-xs-10 col-sm-10 col-md-12 no-pad activity-mobile" ng-if="$root.profileUser.id">
        <div class="status moderator" ng-if="$root.profileUser.status">{{$root.profileUser.status}}</div>
        <h2 class="profile-name ">
          <a ui-sref="profile.main({user_id: $root.profileUser.alias || $root.profileUser.id})">
            <span title="Online" ng-class="$root.isOnline($root.profileUser)"></span>
            <span class="avatar-first-name">{{$root.profileUser.first_name}}</span>
            <br/>
            {{$root.profileUser.last_name}}
          </a>
        </h2>

        <div ng-if="Profile.checkPermision(profileUser.privacy_info)">
          <div class="activity-level">
            {{$root.profileUser.activity_level}}
          </div>
          <div class="age">
            <span ng-if="$root.profileUser.sex">{{$root.profileUser.sex == 'm' ? 'male' : 'female'}}</span>
            <span ng-if="$root.profileUser.birth_date">, {{$root.profileUser.birth_date | age}} years</span>
          </div>
          <div class="location" ng-if="$root.profileUser.address">{{$root.profileUser.address}}</div>

          <div ng-if="$root.profileUser.description">
            <div ng-init="Profile.textLimit = 50"
                 ng-class="{small: Profile.textLimit == 50, 'full-text': Profile.textLimit == 1000}"
                 class="biography">
              {{$root.profileUser.description | limitTo: Profile.textLimit}}
            </div>
            <div ng-if="Profile.textLimit == 50 && $root.profileUser.description.length > 50">
              <a class="more" ng-click="Profile.textLimit = 1000">
                see more
              </a>
            </div>
          </div>
        </div>


        <div ng-if="$root.currentUser && $root.profileUser.id != $root.currentUser.id">
          <send-message></send-message>

          <div class="form-group">
            <button type="button" class="btn btn-default"
                    ng-click="Profile.follow($root.profileUser)"
                    ng-class="{'red-btn': !$root.profileUser.can_follow, 'green-btn': $root.profileUser.can_follow}">
              {{$root.profileUser.can_follow ? 'Follow' : 'Unfollow'}}
            </button>
          </div>
        </div>

        <div ng-if="$root.currentUser.social_links.facebook">Facebook: {{ $root.currentUser.social_links.facebook }}</div>
        <div ng-if="$root.currentUser.social_links.twitter">Twitter: {{ $root.currentUser.social_links.twitter }}</div>
        <div ng-if="$root.currentUser.social_links.insagram">Insagram: {{ $root.currentUser.social_links.insagram }}</div>
        <div ng-if="$root.currentUser.social_links.tumblr">Tumblr: {{ $root.currentUser.social_links.tumblr }}</div>
        <div ng-if="$root.currentUser.social_links.vk">VK: {{ $root.currentUser.social_links.vk }}</div>
        <div ng-if="$root.currentUser.social_links.custom">Personal site: {{ $root.currentUser.social_links.custom }}</div>
        <div ng-if="$root.currentUser.social_links.gplus">Google+: {{ $root.currentUser.social_links.gplus }}</div>

        <div class="info-links hidden-lg hidden-md visible-sm visible-xs  ng-show col-xs-12">
          <a ui-sref="spots({user_id: $root.profileUser.id})" class="events"
             ng-if="Profile.checkPermision(profileUser.privacy_events)">
            {{$root.profileUser.count_spots}}
          </a>
          <a users-modal="followers" user="$root.profileUser" class="followers"
             ng-if="Profile.checkPermision(profileUser.privacy_followers)">
            {{$root.profileUser.count_followers}}
          </a>
          <a users-modal="followings" user="$root.profileUser" class="followings"
             ng-if="Profile.checkPermision(profileUser.privacy_followings)">
            {{ $root.profileUser.count_followings
            }}
          </a>
          <a ui-sref="photos.list({user_id: $root.profileUser.id})" class="albums"
             ng-if="Profile.checkPermision(profileUser.privacy_photo_map)">
            {{$root.profileUser.count_photos}}
          </a>
          <a ui-sref="favorites({user_id: $root.profileUser.id})" class="fav"
             ng-if="Profile.checkPermision(profileUser.privacy_favorites)">
            {{$root.profileUser.count_favorites}}
          </a>
        </div>

      </section>
    </div>

    <div class="col-xs-12 col-md-7 central" ng-class="{'no-background': Profile.$state.includes('planner')}">
      <div ui-view class="ng-cloak"></div>
    </div>

    <div class="col-md-3 hidden-sm hidden-xs activity-profile">

      <aside class="module-sidebar clearfix"
             ng-if="!Profile.$state.is('spot') && $root.profileUser.followers.length > 0 && Profile.checkPermision(profileUser.privacy_followers)">
        <h2 class="sidebar-title">
          <a users-modal="followers" user="$root.profileUser">
            Followers
            <span class="counter">{{$root.profileUser.count_followers}}</span>
          </a>
        </h2>

        <div class="sidebar-row clearfix">
          <div class="col-sm-4 no-pad" ng-repeat="item in $root.profileUser.followers">
            <a ui-sref="profile.main({user_id: item.alias || item.id})">
              <img ng-src="{{item.avatar_url.thumb}}" class="avatar"/>

              <a class="sidebar-user-name"
                 ui-sref="profile.main({user_id: item.alias || item.id})">{{item.first_name}}<br>
                {{item.last_name}}</a>
            </a>
          </div>
        </div>

      </aside>

      <aside class="module-sidebar clearfix"
             ng-if="!Profile.$state.is('spot') && $root.profileUser.followings.length > 0 && Profile.checkPermision(profileUser.privacy_followings)">
        <h2 class="sidebar-title">
          <a users-modal="followings" user="$root.profileUser">
            Following
            <span class="counter">{{$root.profileUser.count_followings}}</span>
          </a>
        </h2>

        <div class="sidebar-row ">
          <div class="col-sm-4 no-pad" ng-repeat="item in $root.profileUser.followings">
            <a ui-sref="profile.main({user_id: item.alias || item.id})">
              <span class="avatar">
              <img ng-src="{{item.avatar_url.thumb}}"/>
              </span>
              <a class="sidebar-user-name"
                 ui-sref="profile.main({user_id: item.alias || item.id})">{{item.first_name}}<br>
                {{item.last_name}}</a>
            </a>
          </div>
        </div>

      </aside>

      <aside class="module-sidebar clearfix"
             ng-if="!Profile.$state.is('spot') && $root.profileUser.spots.length > 0 && Profile.checkPermision(profileUser.privacy_events)">
        <h2 class="sidebar-title">
          <a ui-sref="spots({user_id: $root.profileUser.id})">
            Spots
            <span class="counter">{{$root.profileUser.count_spots}}</span>
          </a>
        </h2>

        <div class="sidebar-row ">
          <div class="col-sm-4 no-pad" ng-repeat="item in $root.profileUser.spots">
            <a ui-sref="spot({user_id: item.user_id, spot_id: item.id})">
              <span class="avatar">
              <img ng-src="{{item.cover_url.thumb}}"/>
</span>
              <a class="sidebar-user-name" ui-sref="spot({user_id: item.user_id, spot_id: item.id})">{{item.title}}</a>
            </a>
          </div>
        </div>

      </aside>

      <aside class="module-sidebar clearfix" ng-if="Profile.$state.is('spot') && $root.currentSpot.photos.length > 0">
        <h2 class="sidebar-title">
          <a>
            Photos
            <span class="counter">{{$root.currentSpot.photos.length}}</span>
          </a>
        </h2>

        <div class="sidebar-row ">
          <div jcarousel images="$root.currentSpot.photos"></div>
        </div>

      </aside>

      <aside class="module-sidebar clearfix" ng-if="Profile.$state.is('spot') && $root.currentSpot.count_members > 0">
        <h2 class="sidebar-title">
          <a users-modal="members" user="$root.currentSpot">
            Members
            <span class="counter">{{$root.currentSpot.count_members}}</span>
          </a>
        </h2>

        <div class="sidebar-row ">
          <div class="col-sm-4 no-pad" ng-repeat="item in $root.currentSpot.members">
            <a ui-sref="profile.main({user_id: item.alias || item.id})">
              <img ng-src="{{item.avatar_url.thumb}}" class="avatar"/>

              <p class="sidebar-user-name">{{item.first_name}}<br> {{item.last_name}}</p>
            </a>
          </div>
        </div>

      </aside>
    </div>
  </div>
</div>

